<app-navbar></app-navbar>

<div class="listar-page">
  <div class="listar-card">

    <h2 class="title">üßæ Listado de Brigadas</h2>

    <!-- Cargando -->
    <div *ngIf="cargando" class="loading">Cargando brigadas...</div>

    <!-- Filtros -->
    <div *ngIf="!cargando && brigadas.length > 0" class="filters-container">

      <!-- ID -->
      <div class="filter-group">
        <label for="filtro-id">ID Brigada</label>
        <input 
          type="text"
          id="filtro-id"
          placeholder="Buscar por ID..."
          [(ngModel)]="filtros.id"
          (input)="aplicarFiltros()">
      </div>

      <!-- Departamento -->
      <div class="filter-group">
        <label for="filtro-depto">Departamento</label>
        <select
          id="filtro-depto"
          [(ngModel)]="filtros.departamento"
          (change)="aplicarFiltros()">

          <option value="">-- Todos --</option>
          <option *ngFor="let depto of departamentosUnicos" [value]="depto">
            {{ depto }}
          </option>
        </select>
      </div>

      <!-- Fecha -->
      <div class="filter-group">
        <label for="filtro-fecha">Fecha Asignaci√≥n</label>
        <input
          type="date"
          id="filtro-fecha"
          [(ngModel)]="filtros.fecha"
          (change)="aplicarFiltros()">
      </div>

      <!-- Bot√≥n limpiar -->
      <button class="btn-limpiar" (click)="limpiarFiltros()">
        Limpiar filtros
      </button>
    </div>

    <!-- Tabla -->
    <div class="table-wrapper" *ngIf="!cargando && brigadasFiltradas.length > 0">
      <table>
        <thead>
          <tr>
            <th>ID Brigada</th>
            <th>Departamento</th>
            <th>Conglomerado</th>
            <th>L√≠der</th>
            <th>Fecha Asignaci√≥n</th>
          </tr>
        </thead>

        <tbody>
          <tr *ngFor="let b of brigadasFiltradas">
            <td>{{ b.id_brigada }}</td>
            <td>{{ b.departamento }}</td>
            <td>{{ b.id_conglomerado }}</td>
            <td>{{ b.lider }}</td>
            <td>{{ b.fecha_asignacion }}</td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Mensajes si no hay registros -->
    <div *ngIf="!cargando && brigadas.length === 0" class="empty">
      No hay brigadas registradas.
    </div>

    <div *ngIf="!cargando && brigadas.length > 0 && brigadasFiltradas.length === 0" class="empty-filtered">
      No hay brigadas que coincidan con los filtros.
    </div>

  </div>
</div>
